# üöÄ –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ Gongbu Platform - –ì–û–¢–û–í–ê!

## ‚úÖ **–ß–¢–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

### **üîß Backend (NestJS)**
- ‚úÖ **FilesService** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–æ–∫, –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- ‚úÖ **FileValidationService** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞, —Ç–∏–ø–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏  
- ‚úÖ **FilesController** - REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ **FilesModule** - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –≤ Course Service
- ‚úÖ **–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** - –¥–æ—Å—Ç—É–ø –ø–æ HTTP
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è** - –≥–æ—Ç–æ–≤–∞ –∫ S3/GCS

### **üì± Frontend (React)**
- ‚úÖ **FileUpload** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç drag&drop
- ‚úÖ **ImageUpload** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π  
- ‚úÖ **VideoUpload** - —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –∏ –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º–∏
- ‚úÖ **fileUploadService** - API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CreateCoursePage** - –ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ URL –ø–æ–ª–µ–π

---

## üéØ **–î–û–°–¢–£–ü–ù–´–ï API –≠–ù–î–ü–û–ò–ù–¢–´**

### **POST /api/v1/files/upload**
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
```bash
curl -X POST http://localhost:3002/api/v1/files/upload \
  -F "file=@image.jpg" \
  -F "context=course-cover" \
  -F "courseId=uuid" \
  -F "isPublic=true"
```

### **POST /api/v1/files/upload/course/:courseId/cover**
–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–ª–æ–∂–∫–∏ –∫—É—Ä—Å–∞
```bash
curl -X POST http://localhost:3002/api/v1/files/upload/course/uuid/cover \
  -F "cover=@cover.jpg"
```

### **POST /api/v1/files/upload/lesson/:lessonId/video**
–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ —É—Ä–æ–∫–∞ (–¥–æ 500MB)
```bash
curl -X POST http://localhost:3002/api/v1/files/upload/lesson/uuid/video \
  -F "video=@lesson.mp4"
```

### **GET /files/***
–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```
http://localhost:3002/files/courses/covers/course-uuid_1234567890_a1b2c3d4.jpg
```

---

## üõ°Ô∏è **–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –í–ê–õ–ò–î–ê–¶–ò–Ø**

### **–ü—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–æ–≤:**
- ‚úÖ **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞** - –ª–∏–º–∏—Ç—ã –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ **MIME —Ç–∏–ø** - –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤
- ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ MIME
- ‚úÖ **Magic bytes** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- ‚úÖ **–ò–º—è —Ñ–∞–π–ª–∞** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ **–ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è** - .exe, .bat, .js –∏ –¥—Ä.

### **–õ–∏–º–∏—Ç—ã –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:**
```typescript
course-cover: 5MB (JPG, PNG, WebP)
course-thumbnail: 2MB (JPG, PNG, WebP)  
lesson-video: 500MB (MP4, WebM, AVI, MOV)
lesson-audio: 100MB (MP3, WAV, AAC, M4A)
lesson-attachment: 50MB (PDF, DOC, ZIP, etc)
user-avatar: 3MB (JPG, PNG, WebP)
```

---

## üí° **–ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨**

### **1. –í React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:**
```tsx
import { ImageUpload } from '@/components/FileUpload';

<ImageUpload
  context="course-cover"
  onUpload={handleUpload}
  maxSize={5 * 1024 * 1024}
  aspectRatio="video"
/>
```

### **2. –í API —Å–µ—Ä–≤–∏—Å–µ:**
```typescript
import { fileUploadService } from '@/services/fileUploadApi';

const result = await fileUploadService.uploadCourseCover(
  courseId, 
  file, 
  (progress) => console.log(`${progress.percentage}%`)
);
```

### **3. –ü—Ä—è–º–æ–µ API –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
const formData = new FormData();
formData.append('file', file);
formData.append('context', 'lesson-video');
formData.append('lessonId', 'uuid');

fetch('/api/v1/files/upload', {
  method: 'POST',
  body: formData
});
```

---

## üé® **–ö–û–ú–ü–û–ù–ï–ù–¢–´ –ò–ù–¢–ï–†–§–ï–ô–°–ê**

### **FileUpload** - –ë–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- ‚úÖ Drag & Drop –∑–æ–Ω–∞
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏  
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### **ImageUpload** - –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–Ω–∏–∞—Ç—é—Ä—ã (Sharp)
- ‚úÖ Aspect ratio –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º

### **VideoUpload** - –î–ª—è –≤–∏–¥–µ–æ
- ‚úÖ –í–∏–¥–µ–æ –ø–ª–µ–µ—Ä –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π  
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

---

## üìä **–°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í**

```
uploads/                          # –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ –∑–∞–≥—Ä—É–∑–æ–∫
‚îú‚îÄ‚îÄ courses/
‚îÇ   ‚îú‚îÄ‚îÄ covers/                   # –û–±–ª–æ–∂–∫–∏ –∫—É—Ä—Å–æ–≤ 
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ course-uuid_timestamp_hash.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ thumb_course-uuid_timestamp_hash.webp
‚îÇ   ‚îî‚îÄ‚îÄ thumbnails/               # –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –∫—É—Ä—Å–æ–≤
‚îú‚îÄ‚îÄ lessons/
‚îÇ   ‚îú‚îÄ‚îÄ videos/                   # –í–∏–¥–µ–æ —É—Ä–æ–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ audio/                    # –ê—É–¥–∏–æ —É—Ä–æ–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ attachments/              # –í–ª–æ–∂–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤
‚îî‚îÄ‚îÄ users/
    ‚îî‚îÄ‚îÄ avatars/                  # –ê–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

---

## üîó **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ö–£–†–°–ê–ú–ò**

### **–í CreateCoursePage:**
- ‚úÖ Drag & Drop –æ–±–ª–æ–∂–∫–∏
- ‚úÖ Drag & Drop –º–∏–Ω–∏–∞—Ç—é—Ä—ã
- ‚úÖ Fallback URL –ø–æ–ª—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ courseData
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

### **–í CourseEditorPage** (–≥–æ—Ç–æ–≤ –∫ –¥–æ—Ä–∞–±–æ—Ç–∫–µ):
- üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ –≤ —É—Ä–æ–∫–∏
- üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ –∑–∞–ø–∏—Å–µ–π
- üîÑ –§–∞–π–ª—ã-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫ —É—Ä–æ–∫–∞–º

---

## üöÄ **–ó–ê–ü–£–°–ö –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **1. –ó–∞–ø—É—Å–∫ Course Service:**
```bash
cd services/course-service
npm run start:dev
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:**
```bash
# Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
http://localhost:3002/docs

# Health check:
http://localhost:3002/health

# –õ–∏–º–∏—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏:
http://localhost:3002/api/v1/files/validation/limits
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
```bash
# –ß–µ—Ä–µ–∑ curl:
curl -X POST http://localhost:3002/api/v1/files/upload \
  -F "file=@test.jpg" \
  -F "context=temp"

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
http://localhost:3002/files/temp/temp_timestamp_hash.jpg
```

---

## üéØ **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò**

### **üìà –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- [ ] AWS S3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] Google Cloud Storage
- [ ] CDN –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] FFMPEG –≤–∏–¥–µ–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [ ] Batch –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- [ ] –í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### **üîß –£–ª—É—á—à–µ–Ω–∏—è:**
- [ ] WebP –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –†–µ–∑–∞–π–∑ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é  
- [ ] –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤ –≤ –ë–î
- [ ] –ö–æ—Ä–∑–∏–Ω–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## ‚úÖ **–†–ï–ó–£–õ–¨–¢–ê–¢**

**–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** 

- üéØ **Backend** - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- üé® **Frontend** - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UX —Å drag&drop
- üõ°Ô∏è **Security** - –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è  
- üì± **UI/UX** - –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏
- ‚ö° **Performance** - –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–û—Ç "–≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É" –¥–æ "–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª" - —Å–∏—Å—Ç–µ–º–∞ —Ñ–∞–π–ª–æ–≤ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞! üöÄ**
